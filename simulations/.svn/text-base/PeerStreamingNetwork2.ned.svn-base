package simpleoverlay.simulations;

import simpleoverlay.controller.SimulationController;
import simpleoverlay.global.ActivePeerTable;
import simpleoverlay.nodes.TrackerNode;
import simpleoverlay.nodes.BootstrapNode;
import simpleoverlay.nodes.PeerNode2;

import inet.nodes.inet.Router;
import inet.nodes.ethernet.EtherSwitch;
import inet.networklayer.autorouting.FlatNetworkConfigurator;
import simpleoverlay.nodes.VideoSourceNode;


network SimplePeerNetwork2 extends BasicNetwork
{
    parameters:
        //        int numPeers = default(1);  // already exists in BasicNetwork.ned
        @display("bgb=472,295");

    submodules:
        bootstrap: BootstrapNode {
            @display("p=228,29");
        }

        videoSourceNode: VideoSourceNode {
            @display("p=395,51");
        }
        //        tracker: TrackerNode {
        //            @display("p=381,29");
        //        }
        peer[numPeers]: PeerNode2 {
            //            @display("p=149,235");
            @display("i=device/pc");
        }
        router: Router {
            @display("p=306,150");
        }
        flatNetworkConfigurator: FlatNetworkConfigurator {
            @display("p=85,91");
            networkAddress = "192.168.0.0";
            netmask = "255.255.0.0";
        }
        simulationController: SimulationController {
            @display("p=85,29");
        }
        gm_activePeerTable: ActivePeerTable {
            @display("p=77,171");
        }
    connections:
        for i=0..numPeers-1 {
            peer[i].pppg++ <--> ethernetline <--> router.pppg++;
        }
        bootstrap.pppg++ <--> ethernetline <--> router.pppg++;

        videoSourceNode.pppg++ <--> ethernetline <--> router.pppg++;

//        tracker.pppg++ <--> ethernetline <--> router.pppg++;

//        tracker.ethg++ <--> ethernetline <--> router.ethg++;

}
